"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){t=t?t._modules:{};function e(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a))}e(t,"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){var i=t.win,r=i.document,s=i.URL||i.webkitURL||i,l=t.dataURLtoBlob=function(t){var e=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(e&&3<e.length&&i.atob&&i.ArrayBuffer&&i.Uint8Array&&i.Blob&&s.createObjectURL){for(var a=i.atob(e[3]),t=new i.ArrayBuffer(a.length),o=new i.Uint8Array(t),n=0;n<o.length;++n)o[n]=a.charCodeAt(n);e=new i.Blob([o],{type:e[1]});return s.createObjectURL(e)}},t=t.downloadURL=function(e,t){var a=i.navigator,o=r.createElement("a");if("string"==typeof e||e instanceof String||!a.msSaveOrOpenBlob){e=""+e;var n=/Edge\/\d+/.test(a.userAgent);if((n||2e6<e.length)&&!(e=l(e)||""))throw new Error("Failed to convert to blob");if(void 0!==o.download)o.href=e,o.download=t,r.body.appendChild(o),o.click(),r.body.removeChild(o);else try{if(null==i.open(e,"chart"))throw new Error("Failed to open window")}catch(t){i.location.href=e}}else a.msSaveOrOpenBlob(e,t)};return{dataURLtoBlob:l,downloadURL:t}}),e(t,"Extensions/ExportData.js",[t["Core/Axis/Axis.js"],t["Core/Chart/Chart.js"],t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/Utilities.js"],t["Extensions/DownloadURL.js"]],function(u,t,o,e,a,n){var i=e.doc,r=e.seriesTypes,s=e.win,l=a.addEvent,m=a.defined,p=a.extend,C=a.find,S=a.fireEvent,e=a.getOptions,E=a.isNumber,L=a.pick,a=a.setOptions,c=n.downloadURL;function h(t,e){var a=s.navigator,o=-1<a.userAgent.indexOf("WebKit")&&a.userAgent.indexOf("Chrome")<0,n=s.URL||s.webkitURL||s;try{if(a.msSaveOrOpenBlob&&s.MSBlobBuilder){var i=new s.MSBlobBuilder;return i.append(t),i.getBlob("image/svg+xml")}if(!o)return n.createObjectURL(new s.Blob(["\ufeff"+t],{type:e}))}catch(t){}}a({exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}),l(t,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&!this.dataTableDiv&&this.viewData()}),t.prototype.setUpKeyToAxis=function(){r.arearange&&(r.arearange.prototype.keyToAxis={low:"y",high:"y"}),r.gantt&&(r.gantt.prototype.keyToAxis={start:"x",end:"x"})},t.prototype.getDataRows=function(n){function e(t,e,a){if(b.columnHeaderFormatter){var o=b.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t instanceof u?t.options.title&&t.options.title.text||(t.dateTime?d:h):n?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):h}function f(a,t,o){var n={},i={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=E(o)?a.chart[e][o]:a[e];n[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:n,dateTimeValueAxisMap:i}}var a,t,o,i,r,s,l,g=this.hasParallelCoordinates,x=this.time,b=this.options.exporting&&this.options.exporting.csv||{},y=this.xAxis,v={},p=[],w=[],D=[],c=this.options.lang.exportData,h=c.categoryHeader,d=c.categoryDatetimeHeader,T=[],A=0;for(i in this.setUpKeyToAxis(),this.series.forEach(function(r){var s,l,t=r.options.keys,p=r.xAxis,c=t||function(t,e){if(!t.data.filter(function(t){return void 0!==t.y&&t.name}).length||!e||e.categories||t.keyToAxis)return t.pointArrayMap||["y"];if(t.pointArrayMap&&t.pointArrayMap.filter(function(t){return"x"===t}).length)return t.pointArrayMap.unshift("x"),t.pointArrayMap;return["x","y"]}(r,p),h=c.length,d=!r.requireSorting&&{},u=y.indexOf(p),m=f(r,c);if(!1!==r.options.includeInDataExport&&!r.options.isInternal&&!1!==r.visible){for(C(T,function(t){return t[0]===u})||T.push([u,A]),l=0;l<h;)o=e(r,c[l],c.length),D.push(o.columnTitle||o),n&&w.push(o.topLevelColumnTitle||o),l++;s={chart:r.chart,autoIncrement:r.autoIncrement,options:r.options,pointArrayMap:r.pointArrayMap},r.options.data.forEach(function(t,e){var a,o,n,i;for(g&&(m=f(r,c,e)),i={series:s},r.pointClass.prototype.applyOptions.apply(i,[t]),a=i.x,t=r.data[e]&&r.data[e].name,l=0,(!p||"name"===r.exportKey||!g&&p&&p.hasNames&&t)&&(a=t),d&&(d[a]&&(a+="|"+e),d[a]=!0),v[a]||(v[a]=[],v[a].xValues=[]),v[a].x=i.x,v[a].name=t,v[a].xValues[u]=i.x;l<h;)n=i[o=c[l]],v[a][A+l]=L(m.categoryMap[o][n],m.dateTimeValueAxisMap[o]?x.dateFormat(b.dateFormat,n):null,n),l++}),A+=l}}),v)Object.hasOwnProperty.call(v,i)&&p.push(v[i]);for(t=n?[w,D]:[D],A=T.length;A--;)s=T[A][0],l=T[A][1],a=y[s],p.sort(function(t,e){return t.xValues[s]-e.xValues[s]}),r=e(a),t[0].splice(l,0,r),n&&t[1]&&t[1].splice(l,0,r),p.forEach(function(t){var e=t.name;a&&!m(e)&&(e=a.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),x.dateFormat(b.dateFormat,t.x)):a.categories?L(a.names[t.x],a.categories[t.x],t.x):t.x),t.splice(l,0,e)});return t=t.concat(p),S(this,"exportData",{dataRows:t}),t},t.prototype.getCSV=function(t){var n="",i=this.getDataRows(),e=this.options.exporting.csv,r=L(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=L(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return i.forEach(function(t,e){for(var a="",o=t.length;o--;)"string"==typeof(a=t[o])&&(a='"'+a+'"'),"number"==typeof a&&"."!==r&&(a=a.toString().replace(".",r)),t[o]=a;n+=t.join(s),e<i.length-1&&(n+=l)}),n},t.prototype.getTable=function(t){var o=function(t){if(!t.tagName||"#text"===t.tagName)return t.textContent||"";var e=t.attributes,a="<"+t.tagName;return e&&Object.keys(e).forEach(function(t){a+=" "+t+'="'+e[t]+'"'}),a+=">",a+=t.textContent||"",(t.children||[]).forEach(function(t){a+=o(t)}),a+="</"+t.tagName+">"},t=this.getTableAST(t);return o(t)},t.prototype.getTableAST=function(t){function c(t,e,a,o){var n=L(o,""),e="text"+(e?" "+e:"");return"number"==typeof n?(n=n.toString(),","===i&&(n=n.replace(".",i)),e="number"):o||(e="empty"),{tagName:t,attributes:a=p({class:e},a),textContent:n}}var e=[],h=this.options,i=t?1.1.toLocaleString()[1]:".",d=L(h.exporting.useMultiLevelHeaders,!0),a=this.getDataRows(d),o=0,n=d?a.shift():null,t=a.shift();!1!==h.exporting.tableCaption&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:L(h.exporting.tableCaption,h.title.text?h.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")});for(var r=0,s=a.length;r<s;++r)a[r].length>o&&(o=a[r].length);e.push(function(t,e,a){var o,n=[],i=0,r=a||e&&e.length,s=0;if(d&&t&&e&&!function(t,e){var a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0}(t,e)){for(var l,p=[];i<r;++i)(l=t[i])===t[i+1]?++s:s?(p.push(c("th","highcharts-table-topheading",{scope:"col",colspan:s+1},l)),s=0):(l===e[i]?h.exporting.useRowspanHeaders?(o=2,delete e[i]):(o=1,e[i]=""):o=1,l=c("th","highcharts-table-topheading",{scope:"col"},l),1<o&&l.attributes&&(l.attributes.valign="top",l.attributes.rowspan=o),p.push(l));n.push({tagName:"tr",children:p})}if(e){for(p=[],i=0,r=e.length;i<r;++i)void 0!==e[i]&&p.push(c("th",null,{scope:"col"},e[i]));n.push({tagName:"tr",children:p})}return{tagName:"thead",children:n}}(n,t,Math.max(o,t.length)));var l=[];a.forEach(function(t){for(var e=[],a=0;a<o;a++)e.push(c(a?"td":"th",null,a?{}:{scope:"row"},t[a]));l.push({tagName:"tr",children:e})}),e.push({tagName:"tbody",children:l});e={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:e}};return S(this,"aftergetTableAST",e),e.tree},t.prototype.downloadCSV=function(){var t=this.getCSV(!0);c(h(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},t.prototype.downloadXLS=function(){var t,e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";c(h(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+(t=e,s.btoa(unescape(encodeURIComponent(t)))),this.getFilename()+".xls")},t.prototype.viewData=function(){this.toggleDataTable(!0)},t.prototype.hideData=function(){this.toggleDataTable(!1)},t.prototype.toggleDataTable=function(t){(t=L(t,!this.isDataTableVisible))&&!this.dataTableDiv&&(this.dataTableDiv=i.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv&&(this.dataTableDiv.style.display=t?"block":"none",t&&(this.dataTableDiv.innerHTML="",new o([this.getTableAST()]).addToDOM(this.dataTableDiv),S(this,"afterViewData",this.dataTableDiv))),this.isDataTableVisible=t;var e=this.exportDivElements,a=this.options.exporting,t=a&&a.buttons&&a.buttons.contextButton.menuItems,a=this.options.lang;d&&d.menuItemDefinitions&&null!=a&&a.viewData&&a.hideData&&t&&e&&e.length&&o.setElementHTML(e[t.indexOf("viewData")],this.isDataTableVisible?a.hideData:a.viewData)};var d=e().exporting;d&&(p(d.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),d.buttons&&d.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),r.map&&(r.map.prototype.exportKey="name"),r.mapbubble&&(r.mapbubble.prototype.exportKey="name"),r.treemap&&(r.treemap.prototype.exportKey="name")}),e(t,"masters/modules/export-data.src.js",[],function(){})});